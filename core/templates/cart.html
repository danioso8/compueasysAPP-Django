{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Carrito de Compras</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/cart.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>
<body>
  {% include "navbarr.html" %}
    <div class="cart-container">
        
        <h1 class="cart-title">Carrito de Compras</h1>
        <div class="cart-actions">
             
             
             <a href="{% url 'clear_cart' %}" class="btn-clear">Vaciar carrito</a>
            
            
       
        </div>
        <div class="cart-table-wrapper">
            <table class="cart-table">
               
                <tbody>
                    {% for item in cart_items %}
                    <tr>
                        <td>
                            {% if item.product.imagen %}
                           
                               <input type="checkbox" name="selected_products" value="{{ item.product.id }}" checked>
                           
                                <img src="{{ item.product.imagen.url }}" alt="{{ item.product.name }}" class="cart-img">
                            {% else %}
                                <span class="cart-no-img">Sin imagen</span>
                            {% endif %}
                        </td>
                        <td>{{ item.product.name }}</td>
                        <td>${{ item.product.price|intcomma|cut:"." }}</td>
                        <td>
                            <form method="post" action="{% url 'update_cart' item.product.id %}" class="cart-qty-form">
                                {% csrf_token %}
                                <button type="submit" name="action" value="decrease" class="btn-qty">-</button>
                                <span class="cart-qty">{{ item.quantity }}</span>
                                <button type="submit" name="action" value="increase" class="btn-qty">+</button>
                            </form>
                        </td>
                        <td>${{ item.subtotal|intcomma|cut:"." }}</td>
                        <td>
                            <a href="{% url 'remove_from_cart' item.product.id %}" class="btn-remove">X</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="cart-empty">No hay productos en tu carrito.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="cart-summary">
            <p>Cantidad de productos: <span class="cart-count">{{ cart_count }}</span></p>
            <h4>Total: <span class="cart-total">${{ cart_total|intcomma|cut:"." }}</span></h4>
             <a href="{% url 'checkout' %}" class="btn-pagar">Pagar  <i class="bi bi-cart-plus-fill fs-1"></i></a>
        </div>
        <div class="cart-ordernote">
              <span class="cart-ordernote-heading">Ingrese una nota de regalo o instrucciones especiales de entrega a continuaci√≥n:</span>
              <div class="form-field">
                <textarea class="form-field-input form-field-textarea" name="note" id="cart-note"></textarea>
                <label class="form-field-title" for="cart-note">Instrucciones especiales</label>
              </div>
            </div>
        <div class="cart-actions">
            <a href="{% url 'store' %}" class="btn-back">&larr; Seguir comprando</a>
        </div>
    </div>
    <script src="{% static 'js/cart.js' %}"></script>
</body>

</html>