{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="stylesheet" href="{% static 'css/product.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet">
    <title>Lista de Productos</title>
</head>
<body>
    <div class="container my-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="mb-0">Lista de Productos</h1>
            <!-- Botón para abrir el modal -->
           
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle shadow-sm rounded">
                <thead class="table-dark">
                    <tr>
                        <th>Imagen</th>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Categoría</th>
                        <th>IVA</th>
                        <th>Descuento</th>
                        <th>Precio Final</th>
                        <th>Creado</th>
                        <th>Actualizado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    <tr>
                        <td>
                            {% if product.imagen %}
                                <img src="{{ product.imagen.url }}" alt="{{ product.name }}" class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
                            {% else %}
                                <span class="text-muted">Sin imagen</span>
                            {% endif %}
                        </td>
                        <td>{{ product.name }}</td>
                        <td>{{ product.description|truncatechars:60 }}</td>
                        <td class="fw-bold text-primary">${{ product.price }}</td>
                        <td>{{ product.stock }}</td>
                        <td>{{ product.categoria }}</td>
                        <td>{{ product.iva }}%</td>
                        <td>{{ product.descuento }}</td>
                        <td class="fw-bold text-success">${{ product.final_price }}</td>
                        <td>{{ product.created_at|date:"Y-m-d H:i" }}</td>
                        <td>{{ product.updated_at|date:"Y-m-d H:i" }}</td>
                        <td>
                            <a href="{% url 'product_edit' product.id %}" class="btn btn-sm btn-warning mb-1">Editar</a>
                            <a href="{% url 'product_delete' product.id %}" class="btn btn-sm btn-danger"
                               onclick="return confirm('¿Estás seguro de eliminar este producto?');">Eliminar</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <h3 class="mt-4">Total Stock: <span class="text-primary">{{ total_stock }}</span></h3>
    </div>

    

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script> 
    <script>
        $(document).ready(function() {
            $('#productTable').DataTable();
        });
    </script>
    <script src="{% static 'js/product.js' %}"></script>
    <!-- Bootstrap Icons (opcional para íconos) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
</body>
</html>